#!/usr/bin/env bash
#
# Create the gallery html page from the list of images found in img/
#

cat > index.md <<EOF
% Artwork
<!-- generated by './build' -->

EOF

mkdir -p img/large
mkdir -p img/medium

for name in $(ls -r -1 img/original); do
  orig=img/original/$name
  large=img/large/$name
  if ! [[ -e "$large" ]]; then
    convert -resize 1600x1600 "$orig" "$large"
  fi
  medium=img/medium/$name
  if ! [[ -e "$medium" ]]; then
    convert -resize 800x800 "$orig" "$medium"
  fi
  cat >> index.md <<EOF
[<img src="$medium" style="padding:20px 0px" alt="abstract"/>]($large)
EOF
done

cat >> index.md <<EOF

[This work](https://mjambon.com/gallery) Â© 2022
by [Martin Jambon](https://mjambon.com) is licensed under
[CC BY-NC-ND 4.0](http://creativecommons.org/licenses/by-nc-nd/4.0/).
EOF
